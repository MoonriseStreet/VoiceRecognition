# Tinkoff Lab. Лабораторная работа "Voice anti spoofing"

### Задание

Предлагается решить задачу бинарной классификации пола по записи голоса. В качестве тренировочного и тестового датасета используется [Common Voice](https://commonvoice.mozilla.org/ru/datasets). 

В этом репозитории представлено моё решение задачи.


### Проведённая работа

Для обучения были случайнным образом выбраны по 1000 записей голосов каждого пола, для тестирования по 200(датасет полностью слишком большой и обработка данных в коллабе стеновится слишком долгой). 


В [ноутбуке](voices.ipynb) находится подробное описание построенных моделей. Для обработки записей используется библиотека `librosa`. К обработанным данным были применены модели из машинного обучения: логистическая регрессия, random forest  и градиентный бустинг, показавшие точность около 90%. Также использовался классификатор из библиотеки `catboost`, с помощью которого удалось достигнуть точности 91%. Потом с помощью фреймворка `PyTorch` была построена простая свёрточная нейросеть, которая показала лучший результат в 92.5%.


### Воспроизведение кода

Чтобы воспроизвести выполнение кода, нужно:

0. Убедиться в том, что у вас установлен `Python3` и библиотеки из [`requirements.txt`](requirements.txt).
1. Скачать датасет [Common Voice](https://commonvoice.mozilla.org/ru/datasets) и распаковать.
2. В той же директории выполнить код из [файла](preprocess.py), после этого будет создана новая директория `data` с выборкой данных для обучения.
3. Выполнить [ноутбук](voices.ipynb).

Так как данные выбираются случайно, выполнение может отличаться от представленного здесь. Чтобы воспроизвести обучение по тем же данным, можно использовать списки файлов для [обучения](train.csv) и [тестирования](test.csv).


### Результаты

В репозитории сохранены веса самых результативных моделей: [catboost](cb_model.cbm) и [свёрточной нейросети](net_model.pth).
